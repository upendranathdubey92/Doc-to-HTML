<!DOCTYPE html>
<html>
<head>
    <title>Test Fixed Detection</title>
    <style>
        body { font-family: Arial, sans-serif; margin: 20px; }
        textarea { width: 100%; height: 300px; }
        .results { margin-top: 20px; padding: 10px; border: 1px solid #ccc; }
        .success { background: #e8f5e8; color: #2e7d32; }
        .error { background: #ffebee; color: #c62828; }
    </style>
</head>
<body>
    <h1>Test Fixed Detection Logic</h1>
    
    <textarea id="testContent">[BENEFITS2]
Benefits of Web Development for a Stronger Online Presence
Web development services offer numerous benefits to businesses, enabling them to grow by boosting visibility, enhancing customer engagement, and increasing sales.
Expand Your Reach Globally
Break geographical boundaries and connect with a broader audience through a responsive, SEO-optimized website.
[BENEFITS2 END]</textarea>
    
    <br><br>
    <button onclick="testDetection()">Test Detection</button>
    
    <div id="results" class="results"></div>

    <script>
        const supportedSections = ['HERO', 'FAQ', 'CTA_SIMPLE', 'CTA_ENHANCED', 'PROCESS', 'TECHNOLOGY', 'INDUSTRIES', 'SERVICES_GRID', 'SERVICES_ACCORDION', 'PORTFOLIO', 'TESTIMONIAL', 'BENEFITS', 'BENEFITS2', 'CONTENT_FORM'];
        
        function detectSections(content) {
            const sectionPattern = /\[([A-Z_\s]+)\]/g;
            const matches = [...content.matchAll(sectionPattern)];
            const detected = matches.map(match => match[1].trim());
            
            // Filter out END markers and only keep supported sections
            return [...new Set(detected)]
                .filter(section => !section.endsWith(' END'))
                .filter(section => 
                    supportedSections.some(supported => 
                        section.includes(supported) || supported.includes(section)
                    )
                );
        }
        
        function testDetection() {
            const content = document.getElementById('testContent').value;
            const resultsDiv = document.getElementById('results');
            
            // Test old logic
            const sectionPattern = /\[([A-Z_\s]+)\]/g;
            const matches = [...content.matchAll(sectionPattern)];
            const allDetected = matches.map(match => match[1].trim());
            const oldResult = [...new Set(allDetected)].filter(section => 
                supportedSections.some(supported => 
                    section.includes(supported) || supported.includes(section)
                )
            );
            
            // Test new logic
            const newResult = detectSections(content);
            
            let html = `
                <h3>Detection Results:</h3>
                <p><strong>All matches found:</strong> ${JSON.stringify(allDetected)}</p>
                <p><strong>Old logic result:</strong> ${JSON.stringify(oldResult)}</p>
                <p><strong>New logic result:</strong> ${JSON.stringify(newResult)}</p>
                <p><strong>New logic count:</strong> ${newResult.length}</p>
            `;
            
            if (newResult.length > 0) {
                html += '<div class="success">✅ Success: Sections detected!</div>';
            } else {
                html += '<div class="error">❌ Error: No valid sections found</div>';
            }
            
            resultsDiv.innerHTML = html;
        }
    </script>
</body>
</html>